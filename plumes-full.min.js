!function(){"use strict";var n=function(n,t){function e(){setTimeout(function(){for(var n=0;n<l.length;n++)l[n]();return a&&r[a]&&r[a].name?r.open(a):void 0})}function i(){t.find("[pl-page]").each(function(){var t=$(this),e=new n.Page(n,r,t);if(e){var i=e.name();if(r[i])return void console.error('Error: "'+i+'" word reserved for Page name.');r[i]=e}}),e()}function o(){var n=0;t.children().each(function(){n>=s&&$(this).remove(),n++})}window.EventsManager.call(this);var r=this,c=t.attr("plumes")||null,a=t.attr("index")||null,u=!1,l=[],s=0,f=null;return c?(this.name=function(){return c},this.init=function(){i(),s=t.children().length},this.ready=function(n){return u?void n.call(this):void l.push(n)},this.open=function(n,e,i){if(e=e||{},!r[n]||!r[n].name)return console.error('Error: "'+n+'" is not a page of '+c+"."),!1;f&&r[f].destroy(),f=n,o();var a=r[f];a.compile(function(){a.link(e,function(n){t.append(n),i&&i()})})},void(this.pageActive=function(){return f})):(console.error('Error: App format needs to have "plumes" not empty attribute.'),!1)};window.Plumes=window.Plumes||{},window.Plumes.App=n}(),function(){"use strict";var n=function(n,t,e,i){function o(n,t,e,i){if(i=i||0,t=0===i?t.split("."):t,"undefined"!=typeof e&&i<t.length-1&&"object"!=typeof n[t[i]]&&(n[t[i]]={}),"undefined"!=typeof n[t[i]]||"undefined"!=typeof e){if(i===t.length-1){if("undefined"!=typeof e){var r=n[t[i]];return n[t[i]]=e,{namespace:t,oldValue:r,value:n[t[i]]}}return n[t[i]]}return o(n[t[i]],t,e,i+1)}}function r(n,t){n=n.jquery?n.get(0):n;var e="pl-collection-";$.each(n.attributes,function(){this.specified&&this.name.length>e.length&&0===this.name.indexOf(e)&&t.call({name:this.name.substr(e.length,this.name.length-e.length),value:this.value})})}function c(n){return i.find(n).not(i.attr("pl-component")?"[pl-component] [pl-component] "+n:"[pl-component] "+n)}function a(e,i,o){o=o||{};var r={};$.each(o,function(){"undefined"!=typeof i[this.from]&&(r[this.to]=n.extendEverything(i[this.from]))}),t.open(e,r)}function u(n,t,e){n[t].call(f,function(){return t<n.length-1?u(n,++t,e):void(e&&e())})}function l(i,o,r){return r=r||0,r<i.length?void new n.Component(n,t,e,$(i.get(r))).compile(function(){l(i,o,++r)}):void(o&&o())}window.EventsManager.call(this);var s="collection-",f=this,p=null,h=null,d="",m=null,v=null;this.el={},this.name=function(){return p},this.app=function(){return t},this.page=function(){return e},this.template=function(){return d},this.templateSrc=function(n){return"undefined"!=typeof n&&(m=n),m},this.controllers=function(n){return"undefined"!=typeof n&&(v=n),v},this.collection=function(n,t){if("undefined"==typeof n)return h;if("undefined"==typeof t)return o(h,n);var e=o(h,n,t);if(e.oldValue!=e.value){var i,r=[];for(i=0;i<e.namespace.length;i++)r.push(e.namespace[i]),f.fire(s+r.join("/"),{value:o(h,r.join("."))});r=s+r.join("/")+"/";var c=f.eventsName();for(i=0;i<c.length;i++){var a=c[i];if(a.length>r.length&&0===a.indexOf(r)){var u=a.substr(s.length,a.length-s.length).replace(/\//g,".");f.fire(a,{value:o(h,u)})}}}return this},this.bind=function(n,t){return f.on("collection."+s+n.replace(/\./g,"/"),function(n){t.call(f,n.value)}),f},this.compile=function(t){if(!d)return m=m?m:i.attr("pl-component-src"),n.registerTemplate(m,function(n){d=n,f.compile(t)}),f;if(i.attr("pl-component-src")){var o=[];r(i,function(){o.push(this)}),i.html(d);var c=i.find("[pl-component]");i.replaceWith(c),i=c,p=i.attr("pl-component"),$.each(o,function(){i.attr("pl-collection-"+this.name,this.value)}),e.registerComponent(f)}else i=$($("<div />").html(d).children().get(0));return l(i.find("[pl-component-src]"),function(){t&&t()}),f},this.link=function(t,o){h=t||{},i.attr("pl-component")&&r(i,function(){var n=this;e.bind(n.value,function(t){f.collection(n.name,t)}),f.collection(n.name,e.collection(n.value))}),c("[pl-value]").each(function(){var n=$(this);f.bind(n.attr("pl-value"),function(t){n.html(t+"")})}),c("[pl-src]").each(function(){var n=$(this);f.bind(n.attr("pl-src"),function(t){n.attr("src",t+"")})}),p&&(f.el[p]=i),c("[pl-element]").each(function(){var n=$(this),t=n.attr("pl-element");f.el[t]=n}),c("[pl-nav-page]").each(function(){var n=$(this),i=n.attr("pl-nav-page"),o=[];r(this,function(){o.push({from:this.value,to:this.name})}),n.click(function(){var n=0,r=e.fire("nav-"+i,{collection:t,callback:function(t){setTimeout(function(){n++,n>=r&&a(i,t,o)})}}).length;r||a(i,f.collection(),o)})}),c("[pl-bind]").each(function(){var n=$(this),t=n.attr("pl-bind"),e=(n.attr("type")||"").toLowerCase(),i=n.get(0).tagName.toLowerCase();"button"==i||"input"==i&&("button"==e||"submit"==e)?n.bind("click",function(){f.collection(t,(f.collection(t)||0)+1)}):"input"==i||"textarea"==i?(f.bind(t,function(t){n.val(t)}),n.bind("propertychange change click keyup input paste",function(){f.collection(t,n.val())})):"form"==i&&n.submit(function(n){n.preventDefault(),f.collection(t,(f.collection(t)||0)+1)})}),$.each(h,function(t,e){f.collection(t,n.extendEverything(e))});var l=v?v:p?n.component(p).controllers:[];return l.length?u(l,0,function(){f.fire("linked"),o&&o(i)}):(f.fire("linked"),void(o&&o(i)))},this.destroy=function(n){return n?(f.on("destroy",function(){n.call(f)}),f):(f.fire("destroy"),f)},this.dom=function(){return i}};window.Plumes=window.Plumes||{},window.Plumes.Component=n}(),function(){"use strict";var n=function(n,t,e){var i=this,o=e.attr("pl-page"),r=[],c=e.attr("src"),a=[];return"script"==e.get(0).tagName.toLowerCase()&&o&&c?(n.Component.call(this,n,t,this,e),this.templateSrc(c),this.name=function(){return o},this.controller=function(n){r.push(n),i.controllers(r)},this.beforeNav=function(n,t){i.on("nav.nav-"+n,function(n){return t.call(this,n.collection,n.callback),!0})},this.registerComponent=function(n){a.push(n)},void this.on("linked",function(){$.each(a,function(){this.link()})})):(console.error('Error: Page format needs to be SCRIPT node with "pl-page" and "src" attributes.'),!1)};window.Plumes=window.Plumes||{},window.Plumes.Page=n}(),function(){"use strict";var n=function(){function n(n){if(n=n||!1,i++,n||i>=o){e=!0;for(var c=0;c<r.length;c++)r[c].call(t)}}window.EventsManager.call(this);var t=this,e=!1,i=0,o=0,r=[],c={},a={},u=0;this.extendEverything=function(n){if("undefined"!=typeof n){if($.isPlainObject(n)&&n)return $.extend(!0,{},n);if($.isArray(n))return $.extend(!0,[],n)}return n},this.init=function(){$("[plumes]").each(function(){var e=new t.App(t,$(this));if(e){var i=e.name();if(t[i])return void console.error('Error: "'+i+'" word reserved for App name.');e.ready(function(){n()}),t[i]=e,o++,e.init()}})},this.ready=function(n){return e?void n.call(t):void r.push(n)},this.registerTemplate=function(n,t){if(a[n])return void(t&&t(a[n]));var e=$("<div />");e.load(n+"?_t="+(new Date).getTime()+ ++u,function(){a[n]=e.html().replace(/({{(.*?)}})/g,'<span pl-value="$2"></span>'),t&&t(a[n])})},this.component=function(n,t){return c[n]=c[n]||{controllers:[]},"function"==typeof t&&c[n].controllers.push(t),c[n]}},t=new n;if(window.Plumes){var e;for(e in window.Plumes)t[e]=window.Plumes[e]}window.Plumes=t}(),$(function(){"use strict";window.Plumes.init()}),function(){"use strict";if(!window.EventsManager){var n=function(){var n=!1;this.stopPropagation=function(){n=!0},this.isStoppedPropagation=function(){return n},this.resetStopPropagation=function(){n=!1}},t=function(){var n={low:-1,normal:0,high:9999999};this.formatPriority=function(t){return("undefined"==typeof t||null===t)&&(t="normal"),"string"==typeof t&&(t in n||(t="normal"),t=n[t]),t},this.sortByPriority=function(n){n.sort(function(n,t){return t.priority-n.priority})}};window.EventsManager=function(){function e(n){return n.split(",").map(function(n){return n.trim()})}function i(n){var t=null;return n=n.split("."),n.length>1?(t=n[0],n=n[1]):n=n[0],{name:n,namespace:t}}function o(n){l[n]&&console.error('EventsManager: Event "'+n+'" is locked for use')}var r=this,c=[],a=[],u=new t,l={},s=new n;this.eventsName=function(){var n=[],t=null;for(t in c)n.push(t);return n},this.eventsStack=function(n){return(c[n]||[]).concat(a)},this.fire=function(n,t){var e=[];if("undefined"!=typeof c[n]){o(n),l[n]=!0,u.sortByPriority(c[n]);for(var i=0,r=c[n].length;r>i;i++){var f=c[n][i]||!1;if(f&&(e.push(f.func.call(s,t)),s.isStoppedPropagation())){s.resetStopPropagation();break}}delete l[n]}if(a.length){u.sortByPriority(a);for(var i=0,r=a.length;r>i;i++){var f=a[i];if(e.push(f.func.call(s,n,t)),s.isStoppedPropagation()){s.resetStopPropagation();break}}}return e},this.on=function(n,t,a){return a=u.formatPriority(a),o(n),e(n).map(function(n){n=i(n),c[n.name]=c[n.name]||[],c[n.name].push({namespace:n.namespace,priority:a,func:t})}),r},this.onSafe=function(n,t,e){return r.removeEvent(n,t),r.on(n,t,e)},this.onAnything=function(n,t,e){return e=u.formatPriority(e),a.push({namespace:n,priority:e,func:t}),r},this.removeEventsNamespace=function(n){var t;for(t in c){for(var e=c[t],i=[],u=e.length-1;u>=0;u--)e[u].namespace!==n&&i.push(e[u]);i.length!==e.length&&(o(t),c[t]=i)}for(var l=[],u=a.length-1;u>=0;u--)a[u].namespace!==n&&l.push(a[u]);return l.length!==a.length&&(a=l),r},this.removeEvent=function(n,t){return o(n),e(n).map(function(n){if(n=i(n),"undefined"!=typeof c[n.name])for(var e=0,o=c[n.name].length;o>e;e++)if((!n.namespace||c[n.name][e].namespace==n.namespace)&&c[n.name][e].func.toString()==t.toString()){c[n.name].splice(e,1);break}for(var e=0,o=a.length;o>e;e++)if((!n.namespace||a[e].namespace==n.namespace)&&a[e].func.toString()==t.toString()){a.splice(e,1);break}}),r},this.removeEvents=function(){c=[],a=[]}}}}();
//# sourceMappingURL=plumes-full.min.js.map